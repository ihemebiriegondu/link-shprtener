<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="./shortener.css">
</head>

<body>
    <h1>Your Recent URLs</h1>
    <button id="go-back"><a href="./sample.html"><img src="./icons8-arrow-pointing-left-30 (2).png" alt=""></a></button>
    <ul>
        <!--Recent urls display here-->
    </ul>
    <div id="clear-btn-div">
        <button id="clear-btn" type="button">Clear all URLs</button>
    </div>

    <script>
        const ul = document.querySelector("ul");

        let tasks = Array.from(JSON.parse(localStorage.getItem("tasks")));

        tasks.forEach(task => {
            const newModalBody = document.querySelector("#new-modal-body");
            const list = document.querySelector("ul");
            const li = document.createElement("li");
            li.innerHTML = `
                <div id="img-div">
                    <img id="www" src="./logo-websites-31321.png" alt="">
                </div>
                <div id="div">
                    <div id="links-div">
                        <div id="links-sub-div">
                        <div>
                            <p id="original-link">${task.originalLink}</p>
                            <p id="bubbed-link">${task.bubbedLink}</p>
                        </div>
                        <p id="link-time">8 hours ago</p>
                    </div>
                    </div>
                    <div id="btn-div">
                        <button id="detailed"><a href="#">Detailed stats</a></button>
                        <button class="copy">
                        <img src="./icons8-copy-17.png" alt="">
                        Copy</button>
                </div>
            `
            ul.insertBefore(li, ul.children[0]);
        })
        localStorage.removeItem('myLinks');

        const clearBtn = document.getElementById("clear-btn");
        const copyBtns = document.querySelectorAll(".copy");

        let clear = () => {
            ul.innerHTML = "";
            localStorage.clear();
        };

        copyBtns.forEach(copyBtn => {
            let copyLinkFunction = () => {
                const copyText = document.getElementById("bubbed-link");
                alert("Copied the text: " + copyText.innerHTML);
            };
            copyBtn.addEventListener("click", copyLinkFunction);
        });
        clearBtn.addEventListener("click", clear);
    </script>
</body>

</html>